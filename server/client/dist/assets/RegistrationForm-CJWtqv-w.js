import{r as N,s as b,j as d,q as C,u as a,F as n}from"./index-CYAi8XUF.js";import{f as c,F as k}from"./faPenToSquare-H85bz21w.js";const f=e=>[{name:"dealer_name",label:"Dealer Name",type:"text",placeholder:"Enter dealer name",defaultValue:e==null?void 0:e.dealer_name},{name:"dealer_address",label:"Dealer Address",type:"text",placeholder:"Enter dealer address",defaultValue:e==null?void 0:e.dealer_address},{name:"owner_name",label:"Owner Name",type:"text",placeholder:"Enter owner name",defaultValue:e==null?void 0:e.owner_name},{name:"owner_address",label:"Owner Address",type:"text",placeholder:"Enter owner address",defaultValue:e==null?void 0:e.owner_address},{name:"machine_model",label:"Machine Model",type:"text",placeholder:"Enter machine model",defaultValue:e==null?void 0:e.machine_model},{name:"serial_number",label:"Serial Number",type:"text",placeholder:"Enter serial number",defaultValue:e==null?void 0:e.serial_number},{name:"install_date",label:"Installation Date",type:"date",placeholder:"Enter installation date",defaultValue:e==null?void 0:e.install_date},{name:"invoice_number",label:"Invoice Number",type:"text",placeholder:"Enter invoice number",defaultValue:e==null?void 0:e.invoice_number},{name:"complete_supply",label:"Complete Supply",type:"select",placeholder:"",defaultValue:e!=null&&e.complete_supply?"true":"false",options:["true","false"]},{name:"pdi_complete",label:"PDI Complete",type:"select",placeholder:"",defaultValue:e!=null&&e.pdi_complete?"true":"false",options:["true","false"]},{name:"pto_correct",label:"PTO Correct",type:"select",placeholder:"",defaultValue:e!=null&&e.pto_correct?"true":"false",options:["true","false"]},{name:"machine_test_run",label:"Machine Test Run",type:"select",placeholder:"",defaultValue:e!=null&&e.machine_test_run?"true":"false",options:["true","false"]},{name:"safety_induction",label:"Safety Induction",type:"select",placeholder:"",defaultValue:e!=null&&e.safety_induction?"true":"false",options:["true","false"]},{name:"operator_handbook",label:"Operator Handbook Received",type:"select",placeholder:"",defaultValue:e!=null&&e.operator_handbook?"true":"false",options:["true","false"]},{name:"date",label:"Date",type:"date",placeholder:"Enter date",defaultValue:e==null?void 0:e.date},{name:"completed_by",label:"Completed By",type:"text",placeholder:"Enter the name of the person who completed this",defaultValue:e==null?void 0:e.completed_by}],A=({id:e,registration:t})=>{const[p,o]=N.useState(!1),y=t?f(t):f(),{mutateAsync:m,isError:x,error:E,isPending:V}=b("registrations"),{mutateAsync:w,isError:j,error:F,isPending:v}=b("registrations",e),u=e?F:E,s=e?j:x,S=e?w:m;async function D(r){r.preventDefault();const l=new FormData(r.currentTarget),P={dealer_name:l.get("dealer_name"),dealer_address:l.get("dealer_address"),owner_name:l.get("owner_name"),owner_address:l.get("owner_address"),machine_model:l.get("machine_model"),serial_number:l.get("serial_number"),install_date:l.get("install_date"),invoice_number:l.get("invoice_number"),complete_supply:l.get("complete_supply")==="on",pdi_complete:l.get("pdi_complete")==="on",pto_correct:l.get("pto_correct")==="on",machine_test_run:l.get("machine_test_run")==="on",safety_induction:l.get("safety_induction")==="on",operator_handbook:l.get("operator_handbook")==="on",date:l.get("date"),completed_by:l.get("completed_by")};try{await S(P)&&!s&&o(!1)}catch(_){console.error("Failed to create warranty claim",_)}}return V||v?d.jsx(C,{}):d.jsxs("section",{id:"form",children:[d.jsx("button",{className:a.btnForm,onClick:()=>o(!p),children:e?d.jsx(n,{icon:c.faPenToSquare}):d.jsxs("div",{children:["Machine Registration",d.jsx(n,{icon:c.faPenToSquare})]})}),d.jsxs(k,{visible:p,onClose:()=>o(!1),children:[d.jsxs("form",{className:a.form,onSubmit:D,children:[d.jsx("h1",{className:a.mainHeading,children:"Machine Registration Form"}),y.map(r=>d.jsxs("div",{children:[d.jsx("label",{htmlFor:r.name,children:r.label}),r.type==="select"?d.jsx("select",{name:r.name,id:r.name,defaultValue:r.defaultValue||"",children:r.options&&r.options.map(l=>d.jsx("option",{value:l,children:l},l))}):d.jsx("input",{type:r.type,name:r.name,id:r.name,placeholder:r.placeholder,defaultValue:r.defaultValue||""})]},r.name)),d.jsx("button",{className:a.btnForm,type:"submit",children:"Submit"})]}),s&&d.jsxs("p",{children:["Error: ",u==null?void 0:u.message]})]})]})};export{A as R};
